// THIS FILE WAS GENERATED BY `xtp-go-bindgen`. DO NOT EDIT.
package main

import (
	pdk "github.com/extism/go-pdk"
)

//go:wasmexport nd_scheduler_callback
func _NdSchedulerCallback() int32 {
	var err error
	_ = err
	pdk.Log(pdk.LogDebug, "NdSchedulerCallback: getting JSON input")
	var input SchedulerCallbackInput
	err = pdk.InputJSON(&input)
	if err != nil {
		pdk.SetError(err)
		return -1
	}

	pdk.Log(pdk.LogDebug, "NdSchedulerCallback: calling implementation function")
	output, err := NdSchedulerCallback(input)
	if err != nil {
		pdk.SetError(err)
		return -1
	}

	pdk.Log(pdk.LogDebug, "NdSchedulerCallback: setting JSON output")
	err = pdk.OutputJSON(output)
	if err != nil {
		pdk.SetError(err)
		return -1
	}

	pdk.Log(pdk.LogDebug, "NdSchedulerCallback: returning")
	return 0
}

// Input provided to the scheduler callback when a scheduled task fires
type SchedulerCallbackInput struct {
	// True if this is a recurring schedule (created via ScheduleRecurring),
	// false if it's a one-time schedule (created via ScheduleOneTime).
	IsRecurring bool `json:"is_recurring"`
	// The payload data that was provided when the task was scheduled.
	// Can be used to pass context or parameters to the callback handler.
	Payload string `json:"payload"`
	// The unique identifier for this scheduled task. This is either the ID
	// provided when scheduling, or an auto-generated UUID if none was specified.
	ScheduleId string `json:"schedule_id"`
}

// Output from the scheduler callback
type SchedulerCallbackOutput struct {
	// Error message if the callback failed to process the scheduled task.
	// Empty or null indicates success. The error is logged but does not
	// affect the scheduling system.
	Error *string `json:"error,omitempty"`
}
